<div class="modal-overlay" (click)="onCancel()">
  <div class="modal-dialog" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Create New Task</h2>
      <button class="btn-close" (click)="onCancel()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <form (ngSubmit)="onSubmit()" class="modal-form">
      <!-- General Error -->
      <div *ngIf="hasError('general')" class="error-message">
        {{ getError('general') }}
      </div>

      <!-- Title Field -->
      <div class="form-group">
        <div class="form-label-row">
          <label for="title">Task Title *</label>
          <span class="char-count">{{ getCharCount('title') }}</span>
        </div>
        <input
          id="title"
          [(ngModel)]="task.title"
          name="title"
          type="text"
          placeholder="Enter task title (3-100 characters)..."
          class="form-input"
          [class.input-error]="hasError('title')"
          maxlength="100"
          required
        />
        <div *ngIf="hasError('title')" class="field-error">
          {{ getError('title') }}
        </div>
      </div>

      <!-- Description Field -->
      <div class="form-group">
        <div class="form-label-row">
          <label for="description">Description</label>
          <span class="char-count">{{ getCharCount('description') }}</span>
        </div>
        <textarea
          id="description"
          [(ngModel)]="task.description"
          name="description"
          placeholder="Add task details... (max 500 characters)"
          class="form-textarea"
          [class.input-error]="hasError('description')"
          rows="4"
          maxlength="500"
        ></textarea>
        <div *ngIf="hasError('description')" class="field-error">
          {{ getError('description') }}
        </div>
      </div>

      <!-- Due Date Field -->
      <div class="form-group">
        <label for="dueDate">Due Date</label>
        <input
          id="dueDate"
          [(ngModel)]="task.dueDate"
          name="dueDate"
          type="date"
          class="form-input"
          [class.input-error]="hasError('dueDate')"
        />
        <div *ngIf="hasError('dueDate')" class="field-error">
          {{ getError('dueDate') }}
        </div>
      </div>

      <!-- Status Field -->
      <div class="form-group">
        <label for="status">Status</label>
        <select
          id="status"
          [(ngModel)]="task.status"
          name="status"
          class="form-select"
        >
          <option value="PENDING">To Do</option>
          <option value="IN_PROGRESS">In Progress</option>
          <option value="DONE">Done</option>
        </select>
      </div>

      <!-- Action Buttons -->
      <div class="modal-actions">
        <button
          type="button"
          class="btn-secondary"
          (click)="onCancel()"
          [disabled]="isSubmitting"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="btn-primary"
          [disabled]="isSubmitting"
        >
          {{ isSubmitting ? 'Creating...' : 'Create Task' }}
        </button>
      </div>
    </form>
  </div>
</div>
